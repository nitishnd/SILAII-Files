{%- comment -%}
{
  "pack_name": "Lookbook - lightbox",
  "pack_author": "Design Packs",
  "license": "¬© Design Packs. All rights reserved. This code is protected by copyright law and may not be reproduced, distributed, or used without explicit permission from the author. Shopify complies with the Digital Millennium Copyright Act (DMCA) and responds to claims of copyright infringement using DMCA procedures, which could result in the termination of your Shopify account.",
  }
}
{%- endcomment -%}

{% comment %} Security Code - hides section when app uninstalled {% endcomment %}
{%- unless content_for_header contains 'design_packs_file.js' -%}
  {%- if request.design_mode -%}
    <div class="dsgn-pck__no-app-warning">
      <div class="dsgn-pck__no-app-warning-background">
      </div>
      <div class="dsgn-pck__no-app-warning-text dsgn-pck__rte">
        <p><strong>WARNING!</strong> This premium section will not display properly without an active subscription for <a href="https://apps.shopify.com/design-packs" target="_blank" rel="noopener nofollow">Design Packs</a>. If you need any support please email <a href="mailto:info@design-packs.com" target="_blank" rel="noopener">info@design-packs.com</a> with your questions.</p>
      </div>
    </div>
  {%- endif -%}
  {%- break -%}
{%- endunless -%}

{%- comment -%} Assign: Preview section js fix {%- endcomment -%}
{%- assign section_id = section.id | replace: '+', '' | replace: '=', '' -%}

{%- comment -%} Color: check if color is set to transparent {%- endcomment -%}
{%- assign button_alpha = section.settings.button_background_color | color_extract: 'alpha' -%}

{%- comment -%} Images: check image crop aspect ratio {%- endcomment -%}
{%- if section.settings.image_crop == 'none' -%}
  {%- assign image_crop_width = section.settings.image.width | default: '1000' -%}
  {%- assign image_crop_height = section.settings.image.height | default: '1200' -%}
{%- else -%}
  {%- assign image_crop_width = section.settings.image_crop | split: ':' | first | times: 1000 -%}
  {%- assign image_crop_height = section.settings.image_crop | split: ':' | last | times: 1000 -%}
{%- endif -%}

{%- comment -%} Images: check product image crop aspect ratio {%- endcomment -%}
{%- assign product_image_crop_width = section.settings.product_image_crop | split: ':' | first | times: 1000 -%}
{%- assign product_image_crop_height = section.settings.product_image_crop | split: ':' | last | times: 1000 -%}

{% comment %} Images: responsive image widths {% endcomment %}
{%- assign widths = '180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 1950, 2100, 2260, 2450, 2700, 3000, 3350, 3750, 4100' -%}

{%- comment -%} Layout: has user entered measurement value into max-width field? {%- endcomment -%}
{%- if section.settings.max_width contains 'px' or section.settings.max_width contains '%' -%}
  {%- assign max_width = section.settings.max_width -%}
{%- else -%}
  {%- assign max_width = section.settings.max_width | append: 'px' -%}
{%- endif -%}

{%- comment -%}Metafield detection: block count {%- endcomment -%}
{%- assign block_images = section.blocks.size -%}

{% comment %} Settings: force lightbox {% endcomment %}
{%- assign enable_lightbox = true -%}

{%- capture minify -%}
{%- comment -%} CSS {%- endcomment -%}
<style>
{%- if enable_lightbox != blank -%}
.bp-img-wrap,.bp-wrap{top:0;left:0;width:100%;height:100%;contain:strict}.bp-controls,.bp-zoomed.bp-small .bp-controls button{pointer-events:none}.bp-cap,.bp-count{color:rgba(255,255,255,.9)}.bp-cap,.bp-controls{transition:opacity .3s}@keyframes bp-fadein{from{opacity:.01}to{opacity:1}}@keyframes bp-bar{from{transform:translateX(-100%)}to{transform:translateX(0)}}@keyframes bp-o{from{transform:rotate(0)}to{transform:rotate(360deg)}}.bp-wrap{position:fixed;z-index:999;touch-action:none;-webkit-tap-highlight-color:transparent}.bp-img,.bp-img-wrap,.bp-inner,.bp-vid audio{position:absolute}.bp-wrap>div:first-child{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.75);animation:.48s cubic-bezier(.215,.61,.355,1) bp-fadein; display: block}.bp-vid audio{left:14px;width:calc(100% - 28px);bottom:14px;height:50px}.bp-inner{top:0;left:0;width:100%;height:100%;display:flex}.bp-html{display:contents}.bp-html>:first-child{margin:auto}.bp-img-wrap.bp-drag .bp-img{cursor:grabbing}.bp-img,.bp-noclose:not(.bp-zoomed) .bp-img-wrap{cursor:zoom-in}.bp-close{contain:layout size}.bp-img{top:50%;left:50%;user-select:none;background-size:100% 100%}.bp-controls,.bp-img div,.bp-img img{top:0;width:100%;position:absolute;height:100%}.bp-img div,.bp-img img{left:0}.bp-img .bp-o,.bp-noclose .bp-x{display:none}.bp-zoomed .bp-img{cursor:grab}.bp-zoomed .bp-cap{opacity:0;animation:none!important}.bp-zoomed.bp-small .bp-controls{opacity:0}.bp-controls{left:0;text-align:left;animation:.3s bp-fadein}.bp-controls button{pointer-events:auto;cursor:pointer;position:absolute;border:0;background:rgba(0,0,0,.15);opacity:.9;transition:.1s;contain:content}.bp-controls button:hover{background-color:rgba(0,0,0,.2);opacity:1}.bp-controls svg{fill:#fff}.bp-count{position:absolute;line-height:1;margin:16px;height:50px;width:100px}.bp-next,.bp-prev{top:50%;right:0;margin-top:-32px;height:64px;width:58px;border-radius:3px 0 0 3px}.bp-next:hover:before,.bp-prev:hover:before{transform:translateX(-2px)}.bp-next:before,.bp-prev:before{content:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23fff'%3E%3Cpath d='M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z'/%3E%3C/svg%3E");position:absolute;left:7px;top:9px;width:46px;transition:.2s}.bp-prev{right:auto;left:0;transform:scalex(-1)}.bp-x{top:0;right:0;height:55px;width:58px;border-radius:0 0 0 3px}.bp-x:before{content:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' fill='%23fff'%3E%3Cpath d='M24 10l-2-2-6 6-6-6-2 2 6 6-6 6 2 2 6-6 6 6 2-2-6-6z'/%3E%3C/svg%3E");position:absolute;width:37px;top:8px;right:10px}.bp-if,.bp-vid{position:relative;margin:auto;background:0 0/100% 100% #000}.bp-bar,.bp-cap,.bp-inline{position:absolute}.bp-if div,.bp-if iframe,.bp-if video,.bp-vid div,.bp-vid iframe,.bp-vid video{top:0;left:0;width:100%;height:100%;position:absolute;border:0}.bp-load{display:flex;background-size:100% 100%;overflow:hidden;z-index:1}.bp-bar{top:0;left:0;height:3px;width:100%;transform:translateX(-100%);background:rgba(255,255,255,.9);border-radius:0 3px 3px 0;animation:4s both bp-bar}.bp-o,.bp-o:after{border-radius:50%;width:90px;height:90px}.bp-o{margin:auto;border:10px solid rgba(255,255,255,.2);border-left-color:rgba(255,255,255,.9);animation:1s linear infinite bp-o}.bp-cap{bottom:2%;background:rgba(9,9,9,.8);border-radius:4px;max-width:95%;line-height:1.3;padding:.6em 1.2em;left:50%;transform:translateX(-50%);width:fit-content;width:-moz-fit-content;display:table;animation:.2s bp-fadein}.bp-cap a{color:inherit}.bp-lock{overflow-y:hidden}.bp-lock body{overflow:scroll}.bp-noclose:not(.bp-zoomed){touch-action:pan-y}@media (prefers-reduced-motion){.bp-wrap *{animation-duration:0s!important}}@media (max-width:500px){.bp-x{height:47px;width:47px}.bp-x:before{width:34px;top:6px;right:6px}.bp-next,.bp-prev{margin-top:-27px;height:54px;width:45px}.bp-next:before,.bp-prev:before{top:7px;left:2px;width:43px}.bp-o,.bp-o:after{border-width:6px;width:60px;height:60px}.bp-count{margin:12px 10px}} .bp-img img:not([src]) {visibility: unset;}
{%- endif -%}

.DP--{{ section_id }} {
  background: {{ section.settings.background_color }};
  margin-top: {{ section.settings.outer_margin }}px;
  margin-bottom: {{ section.settings.outer_margin }}px;
}

.DP--{{ section_id }} .dsgn-pck__sizer {
  padding-top: {{ section.settings.inner_padding }}px;
  padding-bottom: {{ section.settings.inner_padding }}px;
  width: {{ section.settings.base_width }}%;
  max-width: {{ max_width }};
}

.DP--{{ section_id }} .dsgn-pck__grid--main {
  gap: {{ section.settings.gutter }}px;
}

.DP--{{ section_id }} .dsgn-pck__lightbox-true,
.DP--{{ section_id }} a.dsgn-pck__lightbox-true:not([href]) {
  cursor: zoom-in;
}

.DP--{{ section_id }} .dsgn-pck__grid-item {
  position: relative;
  height: 100%;
  overflow: hidden;
  display: flex;
}

.DP--{{ section_id }} .dsgn-pck__grid-alignment-top {
  align-items: flex-start;
}

.DP--{{ section_id }} .dsgn-pck__grid-alignment-center {
  align-items: center;
}

.DP--{{ section_id }} .dsgn-pck__grid-alignment-bottom {
  align-items: flex-end;
}

.DP--{{ section_id }} .dsgn-pck__grid-item img {
  height: auto;
  margin-left: auto;
  margin-right: auto;
  object-fit: cover;
  {%- if section.settings.image_crop != 'none' -%}
    aspect-ratio: {{ image_crop_width }} / {{ image_crop_height }};
  {%- endif -%}
}

{%- comment -%} Lightbox styles {%- endcomment -%}

.dsgn-pck__modal--{{ section_id }}:has(~ .dsgn-pck__modal--{{ section_id }}) {
  display: none;
}

.dsgn-pck__modal--{{ section_id }} {
  {% if section.settings.image_crop != 'none' %}
    .bp-img img:not([src]) {
      object-fit: cover;
    }
  {% endif %}

  {% if section.settings.show_lightbox_count == false %}
    .bp-count {
      display: none;
    }
  {% endif %}

  .bp-html .dsgn-pck__grid--modal {
    display: grid;
    grid-template-columns: 1fr 1fr;
    background: {{ section.settings.text_background_color | default: '#fff' }};
    width: 85%;
    max-width: 1000px;
    overflow: auto;
    position: relative;
    max-height: 98vh;
  }

  .dsgn-pck__image--modal {
    max-height: 95vh;
    overflow: auto;
  }

  .dsgn-pck__content {
    position: absolute;
    top: 0;
    right: 0;
    width: 50%;
    overflow: hidden;
    height: 100%;
  }

  .dsgn-pck__inner-content {
    overflow: auto;
  }
}

{% comment %} Product grid {% endcomment %}
.dsgn-pck__modal--{{ section_id }} .bp-html .dsgn-pck__grid--modal {

  .dsgn-pck__inner-content {
    padding: 20px;
  }

  .dsgn-pck__text--description + .dsgn-pck__featured-products-list {
    margin-top: 35px;
  }

  .dsgn-pck__product {
    margin-bottom: 15px;
  }

  .dsgn-pck__item > a {
    text-decoration: none;
  }

  .dsgn-pck__item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    font-size: 0;
  }

  .dsgn-pck__item .dsgn-pck__image__wrapper {
    display: block;
    align-self: center;
    margin: auto;
  }

  .dsgn-pck__item .dsgn-pck__image__wrapper svg {
    width: 100%;
  }

  .dsgn-pck__product-card__image {
    position: relative;
    display: block;
    margin-bottom: 0;
    z-index: 0;
    flex: 0 0 125px;
    max-width: 40%;
  }

  .dsgn-pck__product-card__image.dsgn-pack__secondary-image--true:hover .dsgn-pck__product-image__second {
    opacity: 1;
  }

  .dsgn-pck__product-card__image.dsgn-pack__secondary-image--true:hover .dsgn-pck__product-image__first {
    opacity: 0;
  }

  .dsgn-pck__product-image__first {
    position: relative;
    transition: opacity .2s ease-in-out;
  }

  .dsgn-pck__product-image__second {
    opacity: 0;
    z-index: 1;
    position: absolute;
    transition: opacity .2s ease-in-out;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
  }

  .dsgn-pck__product-image__second .dsgn-pck__image__wrapper {
    height: 100%;
  }

  .dsgn-pck__product-image__second img {
    object-fit: cover;
    height: 100%;
  }

  .dsgn-pck__product-card {
    position: relative;
    display: flex;
    flex-direction: row;
    height: 100%;
    column-gap: 20px;
  }

  .dsgn-pck__product-card__info--wrapper {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    height: 100%;
    flex: 1;
  }

  .dsgn-pck__product-card__info {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    {%- if section.settings.override_theme_font != blank -%}
    font-family: var(--main-font);
    font-weight: var(--main-font-weight);
    font-style: var(--main-font-style);
    {%- endif -%}
  }

  .dsgn-pck__variant-title {
    padding-bottom: 5px;
    font-weight: bold;
    display: block;
  }

  .dsgn-pck__product-card__info p,
  .dsgn-pck__product-card__info a {
    color: {{ section.settings.text_color }};
    text-decoration: none;
    margin-top: 5px;
    margin-bottom: 5px;
    line-height: var(--dp-g-body-line-height, var(--dp-body-line-height, calc(3px + 2ex + 3px)));
    font-size: calc(var(--dp-g-body-size, var(--dp-body-size, 18px)) * {{ section.settings.text_size | times: 0.008 }});
    {%- if section.settings.override_theme_font != blank -%}
    font-family: var(--main-font);
    font-weight: var(--main-font-weight);
    font-style: var(--main-font-style);
    {%- endif -%}
  }

  .dsgn-pck__product-card__info:hover .dsgn-pck__product-card__variant-info  {
    opacity: 1;
  }

  .dsgn-pck__product-card:hover .dsgn-pck__product-card__info  {
    opacity: 1;
    z-index: 1;
  }

  .dsgn-pck__product-tag {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 0.35rem 1rem;
    border-radius: {{ section.settings.badge_border_radius }}px;
    text-transform: uppercase;
    z-index: 2;
    color: {{ section.settings.badge_text_color }};
    background: {{ section.settings.badge_color }};
    {%- if section.settings.override_theme_font != blank -%}
    font-family: var(--main-font);
    font-weight: var(--main-font-weight);
    font-style: var(--main-font-style);
    {%- endif -%}
    font-size: calc(var(--dp-g-body-size, var(--dp-body-size, 18px)) * {{ section.settings.text_size | times: 0.008 }});
  }

  .dsgn-pck__product .dsgn-pck__product-money_was-price {
    text-decoration: line-through;
    color: {{ section.settings.text_color | color_modify: 'alpha', 0.5 }};
  }

  .dsgn-pck__buy-button {
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    text-decoration: none;
    padding: 0.2em 1.2em;
    margin-top: 1em;
    border: thin solid;
    transition: all 0.3s ease-in-out;
    border-radius: {{ section.settings.button_radius }}px;
    line-height: var(--dp-g-button-line-height, var(--dp-button-line-height, calc(3px + 2ex + 3px)));
    font-family: inherit;
    margin: 15px 0;
    cursor: pointer;
    font-size: calc(var(--dp-g-body-size, var(--dp-body-size, 18px)) * {{ section.settings.text_size | times: 0.008 }});
    {%- if section.settings.override_theme_font != blank -%}
    font-family: var(--main-font);
    font-weight: var(--main-font-weight);
    font-style: var(--main-font-style);
    {%- endif -%}
    color: {{ section.settings.button_label_color }};
    border-color: {%- if button_alpha != 0 -%}{{ section.settings.button_background_color }}{%- else -%}{{ section.settings.button_label_color }}{%- endif -%};
    background-color: {{ section.settings.button_background_color }};
    width: fit-content;
  }

  .dsgn-pck__buy-button:hover {
    opacity: 1;
    {%- if button_alpha != 0 -%}
    background-color: {{ section.settings.button_background_color | color_darken: 10 }};
    border-color: transparent;
    {%- else -%}
    background-color: {{ section.settings.button_label_color | color_modify: 'alpha', 0.1 }}
    {%- endif -%};
  }

  .dsgn-pck__add-to-cart-form--quantity {
    display: flex;
    gap: 5px;
  }

  .dsgn-pck__add-to-cart-form--quantity input[name="quantity"] {
    flex: 1 1 50%;
    max-width: 50px;
    margin: 15px 0;
    text-align: center;
    border-radius: {{ section.settings.button_radius }}px;
    background-color: transparent;
    border-width: thin;
    {%- if button_alpha != 0 -%}
      color: {{ section.settings.button_background_color }};
      border-color: {{ section.settings.button_background_color }};
    {%- else -%}
      color: {{ section.settings.button_label_color }};
      border-color: {{ section.settings.button_label_color }};
    {%- endif -%}
  }

  input[type=number]::-webkit-inner-spin-button {
    {% comment %} opacity: 1; {% endcomment %}
    display: none;
  }



  .dsgn-pck__block .dsgn-pck__small-heading {
    font-size: calc(var(--dp-g-small-heading-size, var(--dp-small-heading-size, 24px)) * {{ section.settings.text_size | times: 0.01 }});
    color: {{ section.settings.text_color }};
    {%- if section.settings.override_theme_font != blank -%}
      font-family: var(--heading-font);
      font-weight: var(--heading-font-weight);
      font-style: var(--heading-font-style);
    {%- endif -%}
  }

  .dsgn-pck__rte p,
  .dsgn-pck__rte ul {
    line-height: var(--dp-g-body-line-height, var(--dp-body-line-height, calc(3px + 2.5ex + 3px)));
    font-size: calc(var(--dp-g-body-size, var(--dp-body-size, 18px)) * {{ section.settings.text_size | times: 0.01 }});
    color: {{ section.settings.text_color }};
    {%- if section.settings.override_theme_font != blank -%}
    font-family: var(--main-font);
    font-weight: var(--main-font-weight);
    font-style: var(--main-font-style);
    {%- endif -%}
  }

  {%- if section.settings.text_alignment == 'center' -%}
    .dsgn-pck__rte ul {
      display: table;
      margin: 0 auto;
      text-align: left;
    }
  {%- elsif section.settings.text_alignment == 'right' -%}
    .dsgn-pck__rte ul {
      display: table;
      margin-left: auto;
      text-align: left;
    }
  {%- endif -%}

  {% comment %} End block styling {% endcomment %}
}

/* Animation */
{%- if section.settings.animation != 'none' -%}
  #DP--{{ section_id }}.dsgn-pck__animation-applied [style*="--dsgn-pck-animate"] {
    animation-name: dsgn-pck__animation--{{ section.settings.animation }};
  }
{%- else -%}
  .DP--{{ section_id }} [style*="--dsgn-pck-animate"] {
    opacity: 1;
  }
{% endif %}

{%- if section.settings.custom_css != blank -%}
  {%- assign custom_section_declarations = section.settings.custom_css | split: '}' -%}
  {%- for declaration in custom_section_declarations -%}
    {%- if declaration contains '{' -%}
      #DP--{{ section_id }} {{ declaration }} }
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}

{%- if section.settings.custom_css != blank -%}
  {%- assign custom_section_declarations = section.settings.custom_css | split: '}' -%}
  {%- for declaration in custom_section_declarations -%}
    {%- if declaration contains '{' -%}
      .dsgn-pck__modal--{{ section_id }} {{ declaration }} }
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}

/* Landscape phone to portrait tablet */
@media (max-width: 767px) {
  .DP--{{ section_id }} .dsgn-pck__grid {
    grid-template-columns: repeat({{ section.settings.mobile_per_row | at_most: section.blocks.size }}, auto);
  }

  .DP--{{ section_id }} .dsgn-pck__mobile-grid-alignment-top {
    align-items: flex-start;
  }

  .DP--{{ section_id }} .dsgn-pck__mobile-grid-alignment-center {
    align-items: center;
  }

  .DP--{{ section_id }} .dsgn-pck__mobile-grid-alignment-bottom {
    align-items: flex-end;
  }

  .dsgn-pck__modal--{{ section_id }} .bp-html .dsgn-pck__grid--modal {
    grid-template-columns: 1fr;
  }

  .dsgn-pck__modal--{{ section_id }} .bp-html .dsgn-pck__grid--modal {

    .dsgn-pck__image--modal {
      max-height: 100vh;
      overflow: auto;
    }

    .dsgn-pck__content {
      position: static;
      width: 100%;
      overflow: auto;
      height: auto;
    }

    .dsgn-pck__inner-content {
      padding: 10px 10px 0;
    }

    .dsgn-pck__text--description {
      text-align: center;
    }

    .dsgn-pck__image__wrapper svg {
      width: 100%;
      height: 100%;
    }
  }
}

/* Landscape phones and down */
@media (max-width: 480px) {
  .DP--{{ section_id }} {
    margin-top: {{ section.settings.outer_margin | divided_by: 2 }}px;
    margin-bottom: {{ section.settings.outer_margin | divided_by: 2 }}px;
  }

  .DP--{{ section_id }} .dsgn-pck__sizer {
    min-width: 70%;
    padding-top: {{ section.settings.inner_padding | divided_by: 2 }}px;
    padding-bottom: {{ section.settings.inner_padding | divided_by: 2 }}px;
  }

  {%- if section.settings.mobile_custom_css != blank -%}
    {%- assign mobile_custom_declarations = section.settings.mobile_custom_css | split: '}' -%}
    {%- for declaration in mobile_custom_declarations -%}
      {%- if declaration contains '{' -%}
        #DP--{{ section_id }} {{ declaration }} }
      {%- endif -%}
    {%- endfor -%}
  {%- endif -%}

  {%- if section.settings.custom_css != blank -%}
    {%- assign custom_section_declarations = section.settings.custom_css | split: '}' -%}
    {%- for declaration in custom_section_declarations -%}
      {%- if declaration contains '{' -%}
        .bp-html .dsgn-pck__grid--modal {{ declaration }} }
      {%- endif -%}
    {%- endfor -%}
  {%- endif -%}
}
</style>

{%- comment -%} HTML {%- endcomment -%}
<section id="DP--{{ section_id }}" class="DP--{{ section_id }} dsgn-pck__gallery-grid dsgn-pck__section">
  {%- if section.settings.anchor_id != blank -%}
    <div id="{{ section.settings.anchor_id | remove: '#' | handleize }}" class="dsgn-pck__anchor-id" style="height: 0; overflow: hidden;"></div>
  {%- endif -%}
  <div class="dsgn-pck__sizer">
    <div class="dsgn-pck__grid dsgn-pck__grid--main dsgn-pck__grid--{{ section.settings.per_row }}-per-row">
      {%- for block in section.blocks -%}
        {% comment %} Remove placeholder images if using metafields {% endcomment %}
        {%- if block.settings.image == blank and block.settings.html5_video == blank and block.settings.youtube_video == blank and section.settings.enable_metafield_detect == true -%}
          {%- assign block_images = block_images | minus: 1 -%}
          {%- if forloop.last and block_images == 0 -%}
            <style>
              .DP--{{ section_id }} {
                display: none;
              }
            </style>
          {%- endif -%}
          {%- continue -%}
        {%- endif -%}

        {%- comment -%} Images: all placeholders {%- endcomment -%}
        {% capture placeholder_url %}{% cycle "farkas-mario-fEGqBatLD3U-unsplash_1080x1623", "toa-heftiba--abWByT3yg4-unsplash_1080x1644", "maude-frederique-lavoie-KCR59MwB8r0-unsplash_1080x1080", "creative-headline-se3GNrXjtdQ-unsplash_1080x720", "aiony-haust-K0DxxljcRv0-unsplash_1080x1623", "ksusha-sosnovskaya-QopYtvEBrps-unsplash_1080x1623", "MYbaRJyR_Iw" %}{% endcapture %}
        {%- assign placeholder_width = placeholder_url | split: '_' | last | split: 'x' | first -%}
        {%- assign placeholder_height = placeholder_url | split: '_' | last | split: 'x' | last -%}
        {%- capture grid_alignment -%}
          {%- if section.settings.grid_alignment == 'bottom_top' -%}
            {%- case section.settings.per_row -%}
              {%- when 2 -%}
                {%- cycle 'per_row': 'bottom', 'bottom', 'top', 'top' -%}
              {%- when 3 -%}
                {%- cycle 'per_row': 'bottom', 'bottom', 'bottom', 'top', 'top', 'top' -%}
              {%- when 4 -%}
                {%- cycle 'per_row': 'bottom', 'bottom', 'bottom', 'bottom', 'top', 'top', 'top', 'top' -%}
              {%- when 5 -%}
                {%- cycle 'per_row': 'bottom', 'bottom', 'bottom', 'bottom', 'bottom', 'top', 'top', 'top', 'top', 'top' -%}
              {%- when 6 -%}
                {%- cycle 'per_row': 'bottom', 'bottom', 'bottom', 'bottom', 'bottom', 'bottom', 'top', 'top', 'top', 'top', 'top', 'top' -%}
            {%- endcase -%}
          {%- else -%}
            {{ section.settings.grid_alignment }}
          {%- endif -%}
        {%- endcapture -%}
        {%- capture mobile_grid_alignment -%}
          {%- if section.settings.grid_alignment == 'bottom_top' -%}
            {%- case section.settings.mobile_per_row -%}
              {%- when 2 -%}
                {%- cycle 'mobile_per_row': 'bottom', 'bottom', 'top', 'top' -%}
              {%- when 3 -%}
                {%- cycle 'mobile_per_row': 'bottom', 'bottom', 'bottom', 'top', 'top', 'top' -%}
              {%- when 4 -%}
                {%- cycle 'mobile_per_row': 'bottom', 'bottom', 'bottom', 'bottom', 'top', 'top', 'top', 'top' -%}
            {%- endcase -%}
          {%- else -%}
            {{ section.settings.grid_alignment }}
          {%- endif -%}
        {%- endcapture -%}
        {%- case block.type -%}
          {%- when 'image' -%}
            {%- capture lightbox_content -%}
              <div class="dsgn-pck__grid--modal">
                <div class="dsgn-pck__image--modal">
                  {%- capture sizes -%}
                    (max-width: 480px) 100vw,(max-width: 767px) 100vw,50vw
                  {%- endcapture -%}
                  {%- if section.settings.image_crop == 'none' -%}
                    {%- if block.settings.lightbox_image != blank -%}
                      {%- assign image_crop_width = block.settings.lightbox_image.width | default: placeholder_width | times: 1000 -%}
                      {%- assign image_crop_height = block.settings.lightbox_image.height | default: placeholder_height | times: 1000 -%}
                    {%- else -%}
                      {%- assign image_crop_width = block.settings.image.width | default: placeholder_width | times: 1000 -%}
                      {%- assign image_crop_height = block.settings.image.height | default: placeholder_height | times: 1000 -%}
                    {%- endif -%}
                  {%- else -%}
                    {%- assign image_crop_width = section.settings.image_crop | split: ':' | first | times: 1000 -%}
                    {%- assign image_crop_height = section.settings.image_crop | split: ':' | last | times: 1000 -%}
                  {%- endif -%}
                  <div class="dsgn-pck__image__wrapper dsgn-pck__image__wrapper--modal">
                    <svg class="dsgn-pck__svg-sizer" viewBox="0 0 {{ image_crop_width }} {{ image_crop_height }}"></svg>
                    {%- if block.settings.lightbox_image != blank -%}
                      {{ block.settings.lightbox_image | image_url: width: 2800 | image_tag:  widths: widths, sizes: sizes }}
                    {%- elsif block.settings.image != blank -%}
                      {{ block.settings.image | image_url: width: 2800 | image_tag:  widths: widths, sizes: sizes }}
                    {%- else -%}
                      <img src="https://cdn.shopify.com/s/files/1/0577/7673/4361/files/{{ placeholder_url }}.jpg"
                        alt=""
                        loading="lazy"
                        width="{{ placeholder_width }}"
                        height="{{ placeholder_height }}">
                    {%- endif -%}
                  </div>
                </div>
                {%- if block.settings.product_list.count > 0 or block.settings.description != blank -%}
                  <div class="dsgn-pck__content dsgn-pck__flex">
                    <div class="dsgn-pck__inner-content">
                      {%- if block.settings.description != blank -%}
                        <div class="dsgn-pck__text dsgn-pck__text--description dsgn-pck__rte dsgn-pck__justify-{{ section.settings.text_alignment }}">
                          {{ block.settings.description }}
                        </div>
                      {%- endif -%}
                      <div class="dsgn-pck__featured-products-list dsgn-pck__flex dsgn-pck__flex-wrap">
                      {%- for product in block.settings.product_list -%}
                        <div class="dsgn-pck__product dsgn-pck__item">
                          <div class="dsgn-pck__product-card">
                            {%- assign featured_image = product.featured_image | default: product.featured_image -%}
                            {%- if featured_image != blank -%}
                              {%- comment -%} Crop based on initial image width and height{%- endcomment -%}
                              {%- if section.settings.product_image_crop == 'none' -%}
                                {%- assign product_image_crop_width = featured_image.width | default: '1000' -%}
                                {%- assign product_image_crop_height = featured_image.height | default: '1000' -%}
                              {%- endif -%}
                              <a class="dsgn-pck__product-card__image {% if product.images[1] != blank and section.settings.show_secondary_image %}dsgn-pack__secondary-image--true{% endif %}" href="{{ product.url }}">
                                {% if section.settings.show_metafield_badge == true and product.metafields[section.settings.badge_metafield_namespace][section.settings.badge_metafield_key] != blank %}
                                  <div class="dsgn-pck__product-tag dsgn-pck__product-tag--metafield">
                                    {{ product.metafields[section.settings.badge_metafield_namespace][section.settings.badge_metafield_key] | metafield_tag | escape }}
                                  </div>
                                {%- elsif section.settings.show_product_label -%}
                                  {%- if product.available != true -%}
                                    <div class="dsgn-pck__product-tag dsgn-pck__product-tag--sold-out">
                                    {{ 'sold_out' | t | escape }}
                                    </div>
                                  {%- endif -%}
                                  {% comment %} Check if product is on sale {% endcomment %}
                                  {% if product.available and product.compare_at_price_max > product.price %}
                                    <div class="dsgn-pck__product-tag dsgn-pck__product-tag--sale">
                                    {{ 'sale' | t | escape }}
                                    </div>
                                  {% endif %}
                                {%- endif -%}
                                <div class="dsgn-pck__product-image__first">
                                  <div class="dsgn-pck__image__wrapper">
                                    <svg viewBox="0 0 {{ product_image_crop_width }} {{ product_image_crop_height }}"></svg>
                                    {%- capture sizes -%}
                                      (max-width: 480px) 75vw,(max-width: 767px) 75vw,{{ section.settings.base_width | divided_by: section.settings.per_row | append: 'vw' | default: '33vw' }}
                                    {%- endcapture -%}
                                    {{ featured_image | image_url: width: product_image_crop_width | image_tag:  widths: widths, sizes: sizes }}
                                  </div>
                                </div>
                                {%- if product.images[1] != blank -%}
                                  <div class="dsgn-pck__product-image__second">
                                    <div class="dsgn-pck__image__wrapper">
                                      <svg viewBox="0 0 {{ product_image_crop_width }} {{ product_image_crop_height }}"></svg>
                                      {{ product.images[1] | image_url: width: product_image_crop_width | image_tag:  widths: widths, sizes: sizes }}
                                    </div>
                                  </div>
                                {%- endif -%}
                              </a>
                            {%- endif -%}
                            <div class="dsgn-pck__product-card__info--wrapper">
                              <div class="dsgn-pck__product-card__info dsgn-pck__justify-{{ section.settings.text_alignment }}">
                                {%- if section.settings.show_product_title -%}
                                  <p class="dsgn-pck__product-title">
                                    <a href="{{ product.url }}" class="dsgn-pck__link">
                                      {%- if variant_loop == true -%}
                                        <span class="dsgn-pck__variant-title">{{ product.title | escape }}</span>
                                      {%- endif -%}
                                      <span class="dsgn-pck__product-title">{{ product.title | escape }}</span>
                                    </a>
                                  </p>
                                {%- endif -%}
                                {%- if section.settings.show_vendor -%}
                                  <p class="dsgn-pck__product-vendor">
                                    {{ product.vendor | link_to_vendor | escape }}
                                  </p>
                                {%- endif -%}
                                {%- if section.settings.show_product_price -%}
                                  {%- liquid

                                    assign price = product.price
                                    assign money_price = price | money
                                    if settings.currency_code_enabled
                                      assign money_price = price | money_with_currency
                                    endif

                                    if product.price_varies
                                      assign money_price = 'from_price_html' | t: price: money_price
                                    endif
                                  -%}
                                  <p class="dsgn-pck__product-money">
                                    {{ money_price }}
                                  {% if product.compare_at_price_max > product.price and product.price_varies == false %}
                                    <span class="dsgn-pck__product-money_was-price">
                                      <span class="money">
                                        {% if settings.currency_code_enabled %}
                                            {{ product.compare_at_price_max | money_with_currency | escape }}
                                          {% else %}
                                            {{ product.compare_at_price_max | money | escape }}
                                          {% endif %}
                                      </span>
                                    </span>
                                  {% endif %}
                                {%- endif -%}
                              </div>
                              {%- if section.settings.show_buy_button -%}
                                {%- if product.available -%}
                                  {%- if product.has_only_default_variant == false and product.variants.size > 1 -%}
                                    <a href="{{ product.url }}" class="dsgn-pck__buy-button">{{ 'buy_button_variant_label' | t }}</a>
                                  {%- else -%}
                                    <form method="post" action="/cart/add" class="dsgn-pck__add-to-cart-form {% if section.settings.show_quantity == true %}dsgn-pck__add-to-cart-form--quantity{% endif %}">
                                      <input type="hidden" name="id" value="{{ product.variants[0].id | default: product.id }}" />
                                      <input {% if section.settings.show_quantity == true %}type="number"{% else %}type="hidden"{% endif %} min="1" id="quantity" name="quantity" value="1"/>
                                      <button type="submit" class="dsgn-pck__buy-button" data-dsgn-pck-add-to-cart="{{ section.settings.add_to_cart_option }}">{{ 'buy_button_label' | t }}</button>
                                    </form>
                                  {%- endif -%}
                                {%- endif -%}
                              {%- endif -%}
                            </div>
                          </div>
                        </div>
                      {%- endfor -%}
                      </div>
                    </div>
                  </div>
                {%- endif -%}
              </div>
            {%- endcapture -%}

            <a class="dsgn-pck__lightbox-{{ enable_lightbox }}"
                data-dsgn-pck-lightbox="{{ enable_lightbox }}"
                {% if block.settings.description != blank or block.settings.product_list.count > 0 %}
                  data-html='{{ lightbox_content }}'
                {%- else -%}
                  data-img="{%- if block.settings.image != blank -%}{{ block.settings.image | image_url: width: 5000 }}{%- else -%}https://cdn.shopify.com/s/files/1/0577/7673/4361/files/{{ placeholder_url }}.jpg{%- endif -%}"
                  data-alt="{{ block.settings.image.alt }}"
                  data-height="{{ image_crop_height }}"
                  data-width="{{ image_crop_width }}"
                {% endif %}
              >
              <div class="dsgn-pck__grid-item dsgn-pck__block-id-{{ block.id }} dsgn-pck__grid-alignment-{{ grid_alignment }} dsgn-pck__mobile-grid-alignment-{{ mobile_grid_alignment }}" {{ block.shopify_attributes }} >
                {%- if block.settings.image != blank -%}
                  {%- capture sizes -%}
                    (max-width: 480px) 100vw, {{ section.settings.base_width | divided_by: section.settings.per_row | append: 'vw' | default: '33vw'}}
                  {%- endcapture -%}
                  {{ block.settings.image | image_url: width: 2800 | image_tag:  widths: widths, sizes: sizes }}
                {%- else -%}
                  <img src="https://cdn.shopify.com/s/files/1/0577/7673/4361/files/{{ placeholder_url }}.jpg"
                    alt=""
                    loading="lazy"
                    width="{{ placeholder_width }}"
                    height="{{ placeholder_height }}">
                {%- endif -%}
              </div>
            </a>
        {%- endcase -%}
      {%- endfor -%}
    </div>
  </div>
</section>
{%- endcapture -%}
{{ minify | strip_newlines }}

{% schema %}
{
  "name": "Lookbook - lightbox",
  "class": "DP__lookbook-lightbox",
  "settings": [
    {
      "type": "range",
      "id": "per_row",
      "label": "Images per row",
      "default": 3,
      "min": 1,
      "max": 6
    },
    {
      "type": "select",
      "id": "image_crop",
      "label": "Image aspect ratio",
      "default": "2:3",
      "options": [
        {
          "value": "4:3",
          "label": "Landscape (4:3)"
        },
        {
          "value": "2:3",
          "label": "Portrait (2:3)"
        },
        {
          "value": "1:1",
          "label": "Square (1:1)"
        },
        {
          "value": "none",
          "label": "Original"
        }
      ]
    },
    {
      "type": "select",
      "id": "grid_alignment",
      "label": "Grid row alignment",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        },
        {
          "value": "bottom_top",
          "label": "Alternating bottom & top"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "gutter",
      "min": 0,
      "max": 40,
      "label": "Gutter size",
      "default": 5
    },
    {
      "type": "header",
      "content": "Lightbox",
    },
    {
      "type": "checkbox",
      "id": "show_lightbox_count",
      "label": "Show lightbox count",
      "default": true
    },
    {
      "type": "header",
      "content": "Products",
      "info": "Visible when an image is selected."
    },
    {
      "type": "select",
      "id": "product_image_crop",
      "label": "Product image aspect ratio",
      "default": "none",
      "options": [
        {
          "value": "4:3",
          "label": "Landscape (4:3)"
        },
        {
          "value": "2:3",
          "label": "Portrait (2:3)"
        },
        {
          "value": "1:1",
          "label": "Square (1:1)"
        },
        {
          "value": "none",
          "label": "Original"
        }
      ]
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "label": "Show second image on hover",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_product_title",
      "label": "Show title",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show vendor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_product_price",
      "label": "Show price",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_buy_button",
      "label": "Show buy button",
      "default": false
    },
    {
      "visible_if": "{{ section.settings.show_buy_button == true }}",
      "type": "select",
      "id": "add_to_cart_option",
      "label": "Buy button action",
      "options": [
        {
          "value": "refresh",
          "label": "Refresh page"
        },
        {
          "value": "go_to_cart",
          "label": "Go to cart"
        },
        {
          "value": "custom_theme_trigger",
          "label": "Run custom code (advanced)"
        }
      ],
      "default": "go_to_cart"
    },
    {
      "visible_if": "{{ section.settings.show_buy_button == true and section.settings.add_to_cart_option == 'custom_theme_trigger' }}",
      "type": "textarea",
      "id": "custom_theme_trigger",
      "label": "JavaScript",
      "info": "Add code to open the slideout cart in your theme or trigger other actions. [Learn more](https://design-packs.gitbook.io/docs/fundamentals/section-settings/add-custom-events-when-product-is-added-to-cart)"
    },
    {
      "visible_if": "{{ section.settings.show_buy_button == true }}",
      "type": "checkbox",
      "id": "show_quantity",
      "label": "Show quantity",
      "default": false
    },
    {
      "type": "header",
      "content": "üì± Mobile"
    },
    {
      "type": "range",
      "id": "mobile_per_row",
      "label": "Images per row",
      "default": 2,
      "min": 1,
      "max": 4
    },
    {
      "type": "header",
      "content": "‚úèÔ∏è Text appearance"
    },
    {
      "type": "range",
      "id": "text_size",
      "label": "Text size",
      "min": 80,
      "max": 150,
      "step": 5,
      "default": 100,
      "unit": "%"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "default": "left",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ]
    },
    {
      "type": "header",
      "content": "üé® Design"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text",
      "default": "#283144"
    },
    {
      "type": "color",
      "id": "text_background_color",
      "label": "Text background",
      "default": "#fff"
    },
    {
      "visible_if": "{{ section.settings.show_buy_button == true }}",
      "type": "color",
      "id": "button_label_color",
      "label": "Buy button label",
      "default": "#4B4949"
    },
    {
      "visible_if": "{{ section.settings.show_buy_button == true }}",
      "type": "color",
      "id": "button_background_color",
      "label": "Buy button background",
      "default": "rgba(0,0,0,0)"
    },
    {
      "visible_if": "{{ section.settings.show_buy_button == true }}",
      "type": "range",
      "id": "button_radius",
      "label": "Buy button border radius",
      "min": 0,
      "max": 50,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "badge_text_color",
      "label": "Badge text",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "badge_color",
      "label": "Badge color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "badge_border_radius",
      "label": "Badge border radius",
      "min": 0,
      "max": 50,
      "step": 1,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "color_background",
      "id": "background_color",
      "label": "Background",
      "default": "linear-gradient(0deg, rgba(255, 255, 255, 1), rgba(255, 255, 255, 1) 100%)"
    },
    {
      "type": "select",
      "id": "animation",
      "label": "Animation",
      "default": "none",
      "options": [
        {
          "value": "fade-in",
          "label": "Fade-in"
        },
        {
          "value": "fade-in-left",
          "label": "Fade-in left"
        },
        {
          "value": "fade-in-right",
          "label": "Fade-in right"
        },
        {
          "value": "fade-in-up",
          "label": "Fade-in up"
        },
        {
          "value": "fade-in-down",
          "label": "Fade-in down"
        },
        {
          "value": "none",
          "label": "None"
        }
      ]
    },
    {
      "type": "header",
      "content": "üñº Layout"
    },
    {
      "type": "range",
      "id": "base_width",
      "label": "Size",
      "min": 60,
      "max": 100,
      "step": 5,
      "default": 95,
      "unit": "%"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Maximum width",
      "placeholder": "eg. 1200px",
      "info": "Sets width constraint for content."
    },
    {
      "type": "range",
      "id": "inner_padding",
      "label": "Inner padding",
      "info": "Only applies to top and bottom.",
      "min": 0,
      "max": 100,
      "default": 40,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "outer_margin",
      "label": "Outer margin",
      "info": "Only applies to top and bottom.",
      "min": 0,
      "max": 100,
      "default": 40,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "üö® Advanced"
    },
    {
      "type": "liquid",
      "id": "custom_css",
      "label": "CSS"
    },
    {
      "type": "liquid",
      "id": "mobile_custom_css",
      "label": "Mobile CSS",
      "info": "Applied on screens less than 480px."
    },
    {
      "type": "text",
      "id": "anchor_id",
      "label": "Link anchor id",
      "placeholder": "#design-pack-section",
      "info": "Enter a unique value to jump to this section from same page using a link or button. Eg. #design-pack-section"
    },
    {
      "type": "checkbox",
      "id": "enable_metafield_detect",
      "label": "Enable metafield detection",
      "default": false,
      "info": "Removes placeholder media content."
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "header",
          "content": "Lightbox content",
          "info": "This content will be displayed in the lightbox when the image is clicked."
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "product_list",
          "id": "product_list",
          "label": "Product list"
        },
        {
          "type": "image_picker",
          "id": "lightbox_image",
          "label": "Lightbox image (optional)",
          "info": "Option to show a different image in the lightbox."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Lookbook - lightbox üéí",
      "blocks": [
        {
          "type": "image",
          "settings": {
          }
        },
        {
          "type": "image",
          "settings": {
          }
        },
        {
          "type": "image",
          "settings": {
          }
        },
        {
          "type": "image",
          "settings": {
          }
        },
        {
          "type": "image",
          "settings": {
          }
        },
        {
          "type": "image",
          "settings": {
          }
        }
      ]
    }
  ],
  "locales": {
    "en": {
      "sold_out": "Sold Out",
      "sale": "Sale",
      "from_price_html": "from {{ price }}",
      "buy_button_variant_label": "View Options",
      "buy_button_label": "Add to Cart",
    }
  }
}
{% endschema %}

{%- comment -%} JSON Settings {%- endcomment -%}
<script type="application/json" data-dsgn-pck="{{ section_id }}">
  {
    "id": {{ section_id | json }},
    "animation": {{ section.settings.animation | json }},
    "enable_lightbox": {{ enable_lightbox | json }},
    "cart_add_url": {{ routes.cart_add_url | json }},
    "custom_theme_trigger": {{ section.settings.custom_theme_trigger | json }}
  }
</script>
{%- comment -%} External scripts {%- endcomment -%}
{%- if enable_lightbox != blank -%}
  <script data-dsgn-pck-external-js="{{ section_id }}" src="https://cdn.shopify.com/s/files/1/0577/7673/4361/files/bigger-picture.min.js?v=1661823226" defer></script>
{%- endif -%}
{%- comment -%} JavaScript {%- endcomment -%}
<script data-dsgn-pck-js="{{ section_id }}" type="module" defer>
(function(){

  const designPack = {
    settings: {},
    bpInstance: null,
    animateSection: function(entries, observer){
      // Target the first entry available.
      let observedSection = entries[0];
      if (observedSection.isIntersecting) {
        observedSection.target.classList.add('dsgn-pck__animation-applied');
      }
    },
    enableLightbox: function(section){
      if (this.bpInstance) {
        this.bpInstance.close();
        this.bpInstance = null;
      }

      this.bpInstance = BiggerPicture({
        target: document.body
      });

      // Add custom class to BP container after initialization
      const bpContainer = document.querySelector('.bp-wrap');
      if (bpContainer) {
        bpContainer.classList.add(`dsgn-pck__modal--${this.settings.id}`);
      }

      const imageLinks = section.querySelectorAll('[data-dsgn-pck-lightbox="true"]');

      for (let link of imageLinks) {
        link.removeEventListener('click', openGallery);
        link.addEventListener('click', openGallery);
      }

      function openGallery(e) {
        e.preventDefault();
        designPack.bpInstance.open({
          items: imageLinks,
          el: e.currentTarget,
          intro: 'fadeup',
          onOpen: function(container) {
            container.classList.add(`dsgn-pck__modal--${designPack.settings.id}`);

            container.querySelectorAll(`[data-dsgn-pck-add-to-cart]`).forEach(function(button){
              console.log("BUTTON", button)
              if (button.dataset.dsgnPckAddToCart == 'refresh' || button.dataset.dsgnPckAddToCart == 'custom_theme_trigger') {
                button.addEventListener('click', function(e){
                  e.preventDefault();
                  const variantId = e.target.parentElement.querySelector('[name="id"]').value;
                  const quantity = e.target.parentElement.querySelector('[name="quantity"]').value;
                  designPack.addItemToCart(variantId, quantity, button.dataset.dsgnPckAddToCart);
                });
              }
            });
          },
        });
      }
    },
    toggleVideo: function(playToggle){
      const videoWrapper = playToggle.closest('.dsgn-pck__video-wrapper');
      const video = videoWrapper.querySelector('video');
      if (video.paused) {
        video.play();
        playToggle.classList.add('dsgn-pck__playing');
      } else {
        video.pause();
        playToggle.classList.remove('dsgn-pck__playing');
      }

      video.addEventListener("ended", () => {
        playToggle.classList.remove('dsgn-pck__playing');
      });
    },
    addItemToCart: function(variantId, quantity, addToCartOption) {
      fetch(designPack.settings.cart_add_url, {
        method: 'post',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
        body: JSON.stringify({
          quantity: quantity,
          id: variantId,
        })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(function(resp) {
        if (addToCartOption == 'custom_theme_trigger') {
          // Execute the custom theme trigger code
          const customCode = designPack.settings.custom_theme_trigger;
          if (customCode) {
            try {
              // Create a function from the string and execute it with the response
              const executeCustomCode = new Function('response', customCode);
              executeCustomCode(resp);
            } catch (error) {
              console.error('Error executing custom theme trigger:', error);
              // Fallback to default behavior
              location.reload();
            }
          } else {
            location.reload();
          }
        } else {
          location.reload();
        }
      })
    },
    load: function(section){

      if (this.settings.animation !== 'none'){
        const options = {
          root: null,
          rootMargin: '0px',
          threshold: [0, 0.25, 0.5, 0.75, 1]
        };
        // Construct Intersection Observer.
        const observer = new IntersectionObserver( this.animateSection, options );
        // Observe if element is present.
        if (section) {
          observer.observe(section);
        }
      }

      if (designPack.settings.enable_lightbox === true){
        designPack.enableLightbox(section);
      }

      const playToggles = section.querySelectorAll(`[data-play-trigger]`);
      if (typeof playToggles !== 'undefined' && playToggles != null) {
        playToggles.forEach((playToggle) => {
          playToggle.addEventListener('click', (e) => {
            this.toggleVideo(e.target)
          });
        });
      }
    },
    unload: function(section){
      section.classList.remove('dsgn-pck__animation-applied');
      if (this.bpInstance) {
        this.bpInstance.close();
        this.bpInstance = null;
      }
    }
  }

  window.addEventListener('shopify:section:unload', function (e) {
    const settings = document.querySelector(`[data-dsgn-pck="${e.detail.sectionId}"]`);
    const sectionId = e.detail.sectionId;
    const section = document.querySelector(`#DP--${e.detail.sectionId}`);
    if (sectionId == designPack.settings.id){
      designPack.unload(section);
    }
  });

  designPack.settings = JSON.parse(document.querySelector('[data-dsgn-pck="{{ section_id }}"]').innerHTML);
  const sectionId = {{ section_id | json }};
  const section = document.querySelector(`#DP--${sectionId}`);

  if (sectionId == designPack.settings.id){
    designPack.load(section);
  }
})()
</script>
